"use strict";(self.webpackChunkgt_library=self.webpackChunkgt_library||[]).push([[870],{7870:function(e,t,o){o.r(t),o.d(t,{default:function(){return R}});var s=o(4333),a=o(9818),r=o(9307),n=o(1401),l=o(5868),c=o(4142),i=o(9148),p=o(6128),m=o(1569),u=o(5622),d=o(8680),g=o(1277),b=o(7712),f=o(2948);const{post:h}=wp.ajax,{parse:y}=wp.blocks,{bypassAuth:v}=ast_block_template_vars;var k=(0,s.compose)((0,a.withSelect)((e=>{const{getImportItemInfo:t,getCurrentScreen:o,getSitePreview:s,getActiveBlockPaletteSlug:a,getActivePagePaletteSlug:r,getDisableAi:n,getAdaptiveMode:l}=e("ast-block-templates");return{importItemInfo:t(),sitePreview:s(),currentScreen:o(),activeBlockPaletteSlug:a(),activePagePaletteSlug:r(),disableAI:n(),adaptiveMode:l()}})),(0,a.withDispatch)((e=>{const{setImportItemInfo:t,setTogglePopup:o,setOnboardingAiPopup:s}=e("ast-block-templates"),{insertBlocks:a}=wp.data.dispatch("core/block-editor");return{setImportItemInfo:t,onSetTogglePopup:o,insertBlocks:a,setOnboardingAiPopup:s}})))((0,r.memo)((e=>{let{setImportItemInfo:t,requiredPlugins:o,importItemInfo:s,title:k,btnClass:w,insertBlocks:I,onSetTogglePopup:_,item:P,onClick:E,onBlockImport:S,activeBlockPaletteSlug:x,activePagePaletteSlug:A,currentScreen:R,disableAI:N,importing:C=!1,adaptiveMode:$,showIcon:T=!0}=e,[j]=(0,r.useState)(s),B=o||[];const O=w||"",[D]=(0,r.useState)(k||"Import"),{index:L}=wp.data.select("core/block-editor").getBlockInsertionPoint(),{importInProgress:q,syncLibNotice:M,stepData:{token:Z}}=(0,a.useSelect)((e=>{const{getImportInProgress:t,getNotice:o,getAIStepData:s}=e(f.L);return{importInProgress:t(),syncLibNotice:o(),stepData:s()}}),[]),{setImportInProgress:z,toggleConnectZipAI:F}=(0,a.useDispatch)(f.L),W="info"===M?.type,H=(0,n.gt)(),K=(e,t,o)=>{(0,g.Am)((0,b.Z)({title:e,message:t}),b.Z.getOptions({type:o}))},Q=async()=>{try{await(0,i.j)({slug:"ultimate-addons-for-gutenberg",init:"ultimate-addons-for-gutenberg/ultimate-addons-for-gutenberg.php",name:"Spectra"})}catch(e){z(!1),K("Import failed!","Spectra activation failed!","error")}},U=()=>{(0,i.j)({slug:"wpforms-lite",init:"wpforms-lite/wpforms.php",name:"WPForms Lite"}).then((()=>{X()})).catch((()=>{z(!1),K("Import failed!","WPForms activation failed!","error")}))},V=()=>{const e=j.original_content,t="all-blocks-grid"===R?"block":"page",o="block"===t?j["blocks-category"][0]:j["pages-category"][0];h({action:"ast_block_templates_import_block",content:e,category:o,_ajax_nonce:ast_block_template_vars._ajax_nonce,style:"all-blocks-grid"===R?x:A,disableAI:N,block_type:t,adaptiveMode:$}).done((e=>{z(!1);const t=(0,n.CN)(y(e));I(t,L,"",!1),G(t[0].clientId),_(),document.getElementById("ast-block-templates-modal-wrap").classList.remove("open"),document.body.classList.remove("ast-block-templates-modal-open"),(H.inactive||H.notInstalled)&&(0,u.iP)(),"function"==typeof S&&S(e,L)})).fail((()=>{z(!1),K("Import failed!","Failed to import the block. Please try again later or contact support for assistance.","error")}))},G=e=>{e&&setTimeout((()=>{const t=J(),o="block-"+e,s=t.getElementById(o);s&&s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}),2500)},J=()=>{const e=document.getElementsByClassName("is-tablet-preview"),t=document.getElementsByClassName("is-mobile-preview");if(0!==e.length||0!==t.length){const o=e[0]||t[0];let s=!1;o&&(s=o.getElementsByTagName("iframe")[0]);const a=s?.contentWindow.document||s?.contentDocument;if(a)return a}return document},X=()=>{j?.["post-meta"]?.["astra-site-wpforms-path"]||""?h({action:"ast_block_templates_import_wpforms",id:j.id,_ajax_nonce:ast_block_template_vars._ajax_nonce}).done((()=>{V()})).fail((()=>{z(!1),K("Import failed!","WPForms import failed!","error")})):V()};return React.createElement(l.Z,{className:(0,n.AK)("min-w-[4.875rem] h-7 hover:shadow-small sp-text-sm",O,(q&&!C||W)&&"opacity-50 cursor-not-allowed"),type:"button",variant:"primary",onClick:Z||v?async e=>{q||W||(z(!0),"function"==typeof E&&E(e),H.notInstalled?await(async()=>{try{await(0,i.H)({slug:"ultimate-addons-for-gutenberg",init:"ultimate-addons-for-gutenberg/ultimate-addons-for-gutenberg.php",name:"Spectra"}),await Q()}catch(e){z(!1),K("Import failed!","Spectra installation failed!","error")}})():H.inactive&&await Q(),(0,m.I)(P.ID,"astra-blocks").then((e=>{t(e),j=e,B=e?.["post-meta"]?.["astra-blocks-required-plugins"]?p.t.parse(e["post-meta"]["astra-blocks-required-plugins"]):[],B.length?"not-installed"===ast_block_template_vars.wpforms_status?(0,i.H)({slug:"wpforms-lite",init:"wpforms-lite/wpforms.php",name:"WPForms Lite"}).then((()=>{U()})).catch((()=>{z(!1),K("Import failed!","WPForms installation failed!","error")})):"inactive"===ast_block_template_vars.wpforms_status?U():X():X()})).catch((e=>{K("Import failed!",e,"error"),z(!0)})))}:async()=>{F(),(0,n.jw)("ast-import",{blockId:P.ID,blockType:P.type,blockPaletteSlug:x,pagePaletteSlug:A})},isSmall:!0,hasPrefixIcon:!C&&T},C?React.createElement(c.Z,{className:"h-4 w-4 !shrink-0"}):React.createElement(React.Fragment,null,T&&React.createElement(d.Z,{className:"h-4 w-4 !shrink-0"}),React.createElement("span",{className:"truncate"},D)))}))),w=o(168);const I=e=>{const t=["skip","logo","fav-icon"];for(const o of t)if(e.includes(o))return!0;return!1},_={linearTween(e,t,o,s){return o*e/s+t},easeInQuad(e,t,o,s){return o*(e/=s)*e+t},easeOutQuad(e,t,o,s){return-o*(e/=s)*(e-2)+t},easeInOutQuad(e,t,o,s){return(e/=s/2)<1?o/2*e*e+t:-o/2*(--e*(e-2)-1)+t},easeInCubic(e,t,o,s){return o*(e/=s)*e*e+t},easeOutCubic(e,t,o,s){return e/=s,o*(--e*e*e+1)+t},easeInOutCubic(e,t,o,s){return(e/=s/2)<1?o/2*e*e*e+t:o/2*((e-=2)*e*e+2)+t}};Object.seal(_);var P=_,E=o(3433);const{spectra_common_styles:S,is_rtl:x}=ast_block_template_vars,A="visible";var R=(0,s.compose)((0,a.withSelect)((e=>{const{getDisableAi:t,getDisablePreview:o,getTogglePopup:s}=e("ast-block-templates");return{disableAi:t(),disablePreview:o(),togglePopup:s()}})))((0,r.memo)((e=>{let{item:t,content:o,stylesheet:s,astraCustomizer:a,globalStylesheet:l,colorPalette:c,dynamicContent:i,selectedImages:p,disableAi:m,togglePopup:u,email:d,phone:g,address:b}=e;const f=(0,r.useRef)(null),h=(0,r.useRef)(null),y=t["thumbnail-image-url"]||"",v=t["featured-image-url"]||"",_=(0,n.gt)();let R=0,N=0;const[C,$]=(0,r.useState)({importing:!1}),[T,j]=(0,r.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`),[B,O]=(0,r.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`);function D(){const e=f?.current,t=h?.current;if(!e||!t)return;const o=e.parentNode.offsetWidth/1200,s=o*t.offsetHeight;e.style.transform=`scale(${o})`,e.style.height=`${s}px`}(0,r.useLayoutEffect)((()=>{let e=!0;const t=p,r=new Image;r.src=y;const n=new Image;n.src=v;const u=h.current;function f(t,o){e&&(t.onload=()=>{o(t.src)})}f(r,j),f(n,O);const k=document.getElementById("astra-wp-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container"),w=document.getElementById("astra-block-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container");let _="";var P,E,x;if(s&&(P=s,E=t,s=m?P:0!==Object.keys(i).length&&i?E&&0===E.length?P:P.replace(/background-image\s*:\s*url\(['"]?([^'")]+)['"]?\)/g,(function(e,t){if(I(t))return e;if(!E[N]?.url)return"";const o=E[N]?.url;return N++,N%=E.length,'background-image: url("'+o+'")'})):P),_+=a?`<style type="text/css" id="gt-astra-customizer">${a}</style>`:"",_+=`<style type="text/css" id="gt-spectra-common-stylesheet">${S}</style>`,_=s?`${_} <style type="text/css" id="gt-common-stylesheet">${s}</style>`:_,l&&(_+=`<style type="text/css" id="gt-global-stylesheet"> ${l} </style>`),k&&(_+=`<style type="text/css" id="gt-wpeditor-css" > ${k} </style>`),w&&(_+=`<style type="text/css" id="gt-blockeditor-css"> ${w} </style>`),u&&o){let e=u.shadowRoot;if(null===e&&(e=u.attachShadow({mode:"open"})),null===e)return;let s=o;if(!m){const e=i??[];e&&Object.keys(e)?.length>0&&Object.keys(e).forEach((t=>{s=null!==e[t]?s.replace(t,e[t]):s})),i&&Object.keys(i).length>0&&(x=s,d&&(x=x.replace("contact@example.com",d)),g&&(x=x.replace("202-555-0188",g)),b&&(x=x.replace("2360 Hood Avenue, San Diego, CA, 92123",b)),s=x,s=q(s))}e.innerHTML=_+'<div class="st-block-container">'+s+"</div>",c.forEach(((t,o)=>{e?.host.style.setProperty(`--ast-global-color-${o}`,t)}));const a=u.shadowRoot.querySelectorAll("img");e&&(a.forEach((e=>{I(e.src)||m||0===t?.length||0===Object.keys(i).length||!i||L(e,"hidden")})),D(),((e,t)=>{m||0!==Object.keys(i).length&&i&&t?.length&&e?.forEach((function(e){I(e.src)||(e.onload=()=>{const o=e.getAttribute("src")||"";if(o.includes("unsplash")||o.includes("pexels")||o.includes("pixabay"))return void L(e,A);const s=t[R];if(void 0!==s)if(s.url.includes("unsplash")||s.url.includes("pexels")||s.url.includes("pixabay")){if(R++,void 0===t[R]&&(R=0),"PICTURE"===e.parentNode.nodeName)e.parentNode.querySelectorAll("source").forEach((e=>{e.setAttribute("srcset",s.optimized_url)})),e.parentNode.querySelector("img").setAttribute("src",s.optimized_url);else{const t=document.createElement("img");t.src=s.optimized_url,e.parentNode.replaceChild(t,e)}L(e,A)}else L(e,A);else L(e,A)},e.onerror=()=>{L(e,A)})}))})(a,t))}return()=>{e=!1}}),[t,m,i,p]),(0,r.useEffect)((()=>{const e=new ResizeObserver(D);return e.observe(document.documentElement),()=>{e&&e.disconnect()}}),[]),(0,r.useEffect)((()=>{const e=document.querySelector("#ast-block-templates-modal-wrap");if(!e)return;const t=new MutationObserver(D);return t.observe(e,{childList:!0,attributes:!0,subtree:!0}),()=>{t&&t.disconnect()}}),[]),(0,r.useEffect)((()=>{const e=h?.current;if(e){const t=e.shadowRoot;c.forEach(((e,o)=>{null!==t&&t.host.style.setProperty(`--ast-global-color-${o}`,e)}))}}),[c]);const L=(e,t)=>{e&&(e.style.visibility=t)},q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return b?e.replace(/(src="https:\/\/maps\.google\.com\/maps\?q=)([^&]+)(&z=\d+&hl=en&t=m&output=embed&iwloc=near")/g,`$1${encodeURIComponent(b)}$3`):e};let M=0,Z=0;const z=(e,t,o)=>{const s=e.scrollTop,a=t-s;let r=0;const n=function(){r+=20;const t=P.linearTween(r,s,a,o);e.scrollTop=t,r<o&&(M=setTimeout(n,20))};n()};(0,r.useEffect)((()=>{u||(R=0,N=0)}),[u]);const F=x?"origin-top-right":"origin-top-left";return React.createElement(E.Z,{className:(0,n.AK)("w-full h-fit p-5",!0===C.importing?"importing":"")},React.createElement("div",{className:(0,n.AK)("cursor-pointer relative border border-solid border-border-primary hover:border-accent-spectra transition duration-150 ease-in-out overflow-hidden group",C.importing&&"border-accent-spectra")},React.createElement("div",{className:`thumbnail left-0 m-0 min-h-[auto] overflow-visible text-left top-0 ${F} relative pointer-events-none`,ref:f},React.createElement("div",{className:"absolute w-[1200px] pointer-events-none max-h-[1600px] overflow-hidden",ref:h},!o&&React.createElement("img",{srcSet:`${B}, ${T}`,src:T,alt:"Preview"}),React.createElement("div",{className:"preview"},React.createElement("span",{className:"ast-block-templates-icon ast-block-templates-icon-search"})))),React.createElement("div",{className:"absolute inset-0 grid grid-cols-1 grid-rows-1 place-items-end",onMouseEnter:()=>{if("page"!==t.type)return;const e=h.current;M&&clearTimeout(M),Z=setTimeout((()=>{z(e,e.scrollHeight,4e3)}),1e3)},onMouseLeave:()=>{Z&&clearTimeout(Z);const e=h.current;M&&clearTimeout(M),z(e,0,1500)}},React.createElement("div",{className:(0,n.AK)("opacity-0 group-hover:opacity-100 w-full flex items-center justify-between px-3 py-2 backdrop-blur-sm bg-white/[0.85] shadow-action-buttons transition-all duration-150 ease-in-out",!0===C.importing?"opacity-100":"")},React.createElement(k,{title:_.notInstalled?"Install Spectra & Insert":_.inactive?"Activate Spectra & Insert":"Insert",showIcon:_.active,liveRequest:!0,item:t,importing:C.importing,onClick:()=>{$({...C,importing:!0})},onBlockImport:()=>{$({...C,importing:!1})}}),React.createElement(w.Z,{item:t})))))})))}}]);